# åŒä»£ç† PCG ç³»ç»Ÿ

**åŸºäºå¤§è¯­è¨€æ¨¡å‹ä»£ç†çš„é›¶æ ·æœ¬ 3D åœ°å›¾ç”Ÿæˆï¼šç”¨äºè¿‡ç¨‹å†…å®¹ç”Ÿæˆ (PCG) çš„åŒä»£ç†æ¶æ„**

åŸºäº [arXiv:2512.10501](https://arxiv.org/abs/2512.10501)

ğŸŒ **[é¡¹ç›®ä¸»é¡µ](https://had0yun.github.io/zero-shot-3d-map-generation-with-llm-agents/)** | ğŸ“„ [arXiv è®ºæ–‡](https://arxiv.org/abs/2512.10501)

[English](README.md) | [í•œêµ­ì–´](README_KR.md) | **ä¸­æ–‡**

## æ¦‚è¿° (Overview)

è¿™æ˜¯ç”¨äºé›¶æ ·æœ¬è¿‡ç¨‹å†…å®¹ç”Ÿæˆ (PCG) å‚æ•°é…ç½®çš„åŒä»£ç† Actor-Critic (å‚ä¸è€…-è¯„è®ºè€…) æ¶æ„çš„å®Œæ•´å®ç°ã€‚è¯¥ç³»ç»Ÿä½¿ç°æˆçš„å¤§è¯­è¨€æ¨¡å‹ (LLM) æ— éœ€è¿›è¡Œé’ˆå¯¹ç‰¹å®šä»»åŠ¡çš„å¾®è°ƒå³å¯ä¸ PCG å·¥å…·è¿›è¡Œäº¤äº’ã€‚

## æ¶æ„ (Architecture)

```
                     ç”¨æˆ·æç¤ºè¯ (P_user)
                            |
                            v
+------------------------------------------------------------------+
|                        ç¼–æ’å™¨ (ORCHESTRATOR)                      |
|  +------------------------------------------------------------+  |
|  |                   ä¸Šä¸‹æ–‡ç®¡ç†å™¨ (CONTEXT MANAGER)            |  |
|  |  - çŠ¶æ€æ›¿æ¢ç­–ç•¥ (State-Replacement Strategyï¼Œå›ºå®šå¤§å°ç¼“å†²åŒº) |  |
|  |  - API æ–‡æ¡£æ³¨å…¥                                            |  |
|  |  - ä½¿ç”¨ç¤ºä¾‹ç®¡ç†                                            |  |
|  +------------------------------------------------------------+  |
|                            |                                      |
|      +---------------------+---------------------+               |
|      |                                           |               |
|      v                                           v               |
|  +-------------------+                   +-------------------+   |
|  |   Actor ä»£ç†      |      S_i          |   Critic ä»£ç†     |   |
|  |   (è¯­ä¹‰è§£é‡Šå™¨)    | ----------------> |   (é™æ€éªŒè¯å™¨)    |   |
|  |                   |                   |                   |   |
|  |                   | <---------------- |                   |   |
|  |  æ¸©åº¦ (Temp):     |     åé¦ˆ (FB)     |  æ¸©åº¦ (Temp):     |   |
|  |     0.4           |                   |     0.2           |   |
|  +-------------------+                   +-------------------+   |
|                            |                                      |
|                   +--------+--------+                            |
|                   |   æ‰¹å‡†é€šè¿‡ï¼Ÿ    |                            |
|                   +--------+--------+                            |
|                     æ˜¯ (Yes) |   å¦ (No)                         |
|                      |       |     |                             |
|                      v       |     v                             |
|                  [è¿”å›]      | [è¿­ä»£ æˆ– å°½åŠ›è€Œä¸º]                |
+------------------------------------------------------------------+
                            |
                            v
                   ä¼˜åŒ–ç»“æœ (S_final)
```

## å®‰è£… (Installation)

```bash
# å®‰è£…ä¾èµ–é¡¹
pip install -r requirements.txt

# è®¾ç½®ä½ çš„ API å¯†é’¥
export ANTHROPIC_API_KEY=your-key-here  # Linux/Mac
set ANTHROPIC_API_KEY=your-key-here     # Windows
```

## ä½¿ç”¨æ–¹æ³• (Usage)

### ä½¿ç”¨çœŸå® API è¿è¡Œ

```bash
python -m dual_agent_pcg.main
```

### åœ¨æ¨¡æ‹Ÿæ¨¡å¼ä¸‹è¿è¡Œï¼ˆæ— éœ€ APIï¼‰

```bash
python -m dual_agent_pcg.main --mock
```

---

## ğŸš€ å¿«é€Ÿå…¥é—¨ - ç›´æ¥å¤åˆ¶æ­¤æç¤ºè¯ï¼

**ä¸æƒ³è¿›è¡Œç¹ççš„è®¾ç½®ï¼Ÿ** åªéœ€å¤åˆ¶ä¸‹é¢çš„æç¤ºè¯å¹¶å°†å…¶ç²˜è´´åˆ°ä½ æœ€å–œæ¬¢çš„ LLM å‘½ä»¤è¡Œç•Œé¢ï¼ˆå¦‚ Claudeã€ChatGPT ç­‰ï¼‰ä¸­ã€‚å°† `$ARGUMENTS` æ›¿æ¢ä¸ºä½ çš„åœ°å›¾æè¿°ï¼Œå³å¯å¼€å§‹ä½¿ç”¨ï¼

<details>
<summary><strong>ğŸ“‹ ç‚¹å‡»ä»¥å±•å¼€å®Œæ•´æç¤ºè¯</strong></summary>

```markdown
# åŒä»£ç† PCG åœ°å›¾ç”Ÿæˆ (Dual-Agent PCG Map Generation)

ä½ æ­£åœ¨æ‰§è¡Œ **é›¶æ ·æœ¬åŒä»£ç† PCG ä¼˜åŒ–åè®® (Zero-shot Dual-Agent PCG Refinement Protocol)** (arXiv:2512.10501)ã€‚

## ç”¨æˆ·è¯·æ±‚ (P_user)

**åœ°å›¾æè¿°**: $ARGUMENTS

---

## åè®® (Protocol)

ä½ å°†åœ¨ä¸¤ä¸ªè§’è‰²ä¹‹é—´äº¤æ›¿åˆ‡æ¢ï¼Œç›´åˆ°æ”¶æ•›ï¼ˆæœ€å¤š 3 æ¬¡è¿­ä»£ï¼‰ï¼š

### ACTOR è§’è‰² (è¯­ä¹‰è§£é‡Šå™¨)
ç”Ÿæˆ JSON æ ¼å¼çš„å‚æ•°è½¨è¿¹åºåˆ— (Parameter Trajectory Sequence)ã€‚ä½ å¿…é¡»ï¼š
- å°†ç”¨æˆ·çš„æ„å›¾è½¬åŒ–ä¸ºå…·ä½“çš„ PCG å·¥å…·é…ç½®
- åŒ…å«å…·ä½“çš„å‚æ•°å€¼ï¼ˆç¦æ­¢ä½¿ç”¨å¦‚ "TBD" ä¹‹ç±»çš„å ä½ç¬¦ï¼‰
- æ‰€æœ‰çš„å·¥å…·åç§°å’Œå‚æ•°å¿…é¡»åŸºäºä¸‹æ–¹çš„ API æ–‡æ¡£
- è¯†åˆ«é£é™©å’Œå‡è®¾

### CRITIC è§’è‰² (é™æ€éªŒè¯å™¨)  
æ ¹æ®æ–‡æ¡£è¯„å®¡è½¨è¿¹ã€‚åº”ç”¨äº”ç»´è¯„å®¡æ¡†æ¶ï¼š
1. **å·¥å…·é€‰æ‹© (Tool Selection)**ï¼šæ¯ä¸ªå·¥å…·çš„åç§°æ˜¯å¦å®Œå…¨åŒ¹é…ï¼Ÿ
2. **å‚æ•°æ­£ç¡®æ€§ (Parameter Correctness)**ï¼šæ‰€æœ‰å¿…å¡«å‚æ•°æ˜¯å¦é½å…¨ï¼Ÿæ•°å€¼æ˜¯å¦åœ¨æœ‰æ•ˆèŒƒå›´å†…ï¼Ÿ
3. **é€»è¾‘ä¸é¡ºåº (Logic & Sequence)**ï¼šç”Ÿæˆå™¨ (Generators) æ˜¯å¦åœ¨ä¿®æ”¹å™¨ (Modifiers) ä¹‹å‰è°ƒç”¨ï¼Ÿä¾èµ–å…³ç³»æ˜¯å¦æ»¡è¶³ï¼Ÿ
4. **ç›®æ ‡å¯¹é½ (Goal Alignment)**ï¼šè½¨è¿¹æ˜¯å¦å®ç°äº†ç”¨æˆ·çš„è¦æ±‚ï¼Ÿ
5. **å®Œæ•´æ€§ (Completeness)**ï¼šæ˜¯å¦æœ‰é—æ¼çš„æ­¥éª¤ï¼Ÿ

**ä¿å®ˆç­–ç•¥ (CONSERVATIVE POLICY)**ï¼šä»…åœ¨ç¡®å®šå­˜åœ¨é—®é¢˜æ—¶æ‰æŒ‡å‡ºã€‚

---

## æ‰§è¡Œæµç¨‹ (Execution Flow)

1. [ACTOR] ç”Ÿæˆåˆå§‹è½¨è¿¹ Sâ‚€
2. [CRITIC] è¯„å®¡ Sâ‚€ â†’ äº§ç”Ÿåé¦ˆ
3. å¦‚æœå‘ç°é—®é¢˜ä¸”è¿­ä»£æ¬¡æ•° < 3:
   [ACTOR] æ ¹æ®åé¦ˆä¿®è®¢è½¨è¿¹ â†’ Sâ‚
   [CRITIC] è¯„å®¡ Sâ‚
   ... é‡å¤ç›´åˆ°æ‰¹å‡†é€šè¿‡æˆ–è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°
4. è¾“å‡ºæœ€ç»ˆæ‰¹å‡†çš„è½¨è¿¹

---

## API æ–‡æ¡£ (D)

### ç”Ÿæˆå™¨ (Generators)ï¼ˆå¿…é¡»åœ¨ä¿®æ”¹å™¨ä¹‹å‰è°ƒç”¨ï¼‰

#### CellularAutomataGenerator
åˆ›å»ºæœ‰æœºé™†åœ°æ¨¡å¼ã€‚é€‚ç”¨äºå²›å±¿ã€å¤§é™†ã€æ´ç©´ã€‚

**å¿…å¡«å‚æ•°ï¼š**
- `width` (int): ç½‘æ ¼å®½åº¦ [16, 256]
- `height` (int): ç½‘æ ¼é«˜åº¦ [16, 256]  
- `fill_probability` (float): åˆå§‹å¡«å……ç‡ [0.0, 1.0]
  - 0.3-0.4: åˆ†æ•£çš„é™†åœ°
  - 0.45-0.55: å‡è¡¡ã€è¿é€šçš„é™†åœ°
  - 0.6-0.7: è¾ƒå¤§çš„ã€å®å¿ƒçš„é™†åœ°å—
- `iterations` (int): å¹³æ»‘å¤„ç†æ¬¡æ•° [1, 10]
- `birth_limit` (int): å‡ºç”Ÿé˜ˆå€¼ [0, 8]ï¼ˆé€šå¸¸ä¸º 4ï¼‰
- `death_limit` (int): æ­»äº¡é˜ˆå€¼ [0, 8]ï¼ˆé€šå¸¸ä¸º 3ï¼‰

**å¯é€‰å‚æ•°ï¼š** `seed` (int)

#### PerlinNoiseGenerator
åˆ›å»ºå¹³æ»‘çš„é«˜åº¦å›¾ã€‚é€‚ç”¨äºæµ·æ‹”ã€å±±è„‰ã€ä¸˜é™µã€‚

**å¿…å¡«å‚æ•°ï¼š**
- `width` (int): ç½‘æ ¼å®½åº¦ [16, 512]
- `height` (int): ç½‘æ ¼é«˜åº¦ [16, 512]
- `scale` (float): å™ªå£°ç¼©æ”¾ [0.01, 1.0]
  - 0.01-0.03: å·¨å¤§ä¸”å¹³æ»‘çš„ç‰¹å¾
  - 0.04-0.08: é€‚ç”¨äºå±±è„‰
  - 0.1+: ç²—ç³™ä¸”ç»†èŠ‚ä¸°å¯Œ
- `octaves` (int): ç»†èŠ‚å±‚æ•° [1, 8]
- `persistence` (float): æŒ¯å¹…è¡°å‡ [0.0, 1.0]

**å¯é€‰å‚æ•°ï¼š** `seed` (int), `lacunarity` (float, é»˜è®¤ 2.0)

### ä¿®æ”¹å™¨ (Modifiers)ï¼ˆåœ¨ç”Ÿæˆå™¨ä¹‹ååº”ç”¨ï¼‰

#### HeightLayerModifier
åˆ›å»ºç¦»æ•£çš„æµ·æ‹”åŒºåŸŸã€‚

**å¿…å¡«å‚æ•°ï¼š**
- `layer_count` (int): å›¾å±‚æ•°é‡ [1, 10]
- `layer_heights` (list[float]): é˜ˆå€¼åˆ—è¡¨ï¼Œå‡åºæ’åˆ—
- `blend_factor` (float): è¿‡æ¸¡å¹³æ»‘åº¦ [0.0, 0.5]

#### ScatterModifier
åœ¨åœ°å½¢ä¸Šæ•£å¸ƒç‰©ä½“ã€‚

**å¿…å¡«å‚æ•°ï¼š**
- `object_type` (str): ä»¥ä¸‹ä¹‹ä¸€ï¼š"rock" (å²©çŸ³), "tree" (æ ‘æœ¨), "grass_clump" (è‰ä¸›), "bush" (çŒæœ¨), "flower" (èŠ±å‰)
- `density` (float): æ•£å¸ƒå¯†åº¦ [0.0, 1.0]
- `valid_layers` (list[int]): å…è®¸æ•£å¸ƒçš„å›¾å±‚ç´¢å¼•åˆ—è¡¨

#### GrassDetailModifier
ä¸ºç‰¹å®šå›¾å±‚æ·»åŠ è‰åœ°è¦†ç›–ã€‚

**å¿…å¡«å‚æ•°ï¼š**
- `target_layer` (int): å›¾å±‚ç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼‰
- `coverage` (float): è¦†ç›–ç™¾åˆ†æ¯” [0.0, 1.0]

---

## è¾“å‡ºæ ¼å¼ (Output Format)

ä»¥ JSON æ ¼å¼è¾“å‡ºæœ€ç»ˆæ‰¹å‡†çš„è½¨è¿¹ï¼š

{
  "final_trajectory": {
    "trajectory_summary": "<æ¦‚è¿°>",
    "tool_plan": [
      {
        "step": 1,
        "objective": "<æ­¤æ­¥éª¤å®ç°çš„ç›®æ ‡>",
        "tool_name": "<ç²¾ç¡®çš„å·¥å…·åç§°>",
        "arguments": { ... },
        "expected_result": "<æˆåŠŸæ ‡å‡†>"
      }
    ],
    "risks": ["<æ½œåœ¨é—®é¢˜>"]
  }
}

---

## å¼€å§‹åè®® (BEGIN PROTOCOL)

ç°åœ¨ä¸ºä»¥ä¸‹å†…å®¹æ‰§è¡ŒåŒä»£ç†ä¼˜åŒ–ï¼š**$ARGUMENTS**

é¦–å…ˆç”± [ACTOR] ç”Ÿæˆåˆå§‹è½¨è¿¹ Sâ‚€ã€‚
```

</details>

> ğŸ’¡ å…³äºå¸¦æœ‰ä½¿ç”¨ç¤ºä¾‹çš„å®Œæ•´æç¤ºè¯ï¼Œè¯·å‚é˜… [`.opencode/command/Map.md`](.opencode/command/Map.md)

---

## OpenCode é›†æˆï¼ˆæ¨èï¼‰

**æ— éœ€ API å¯†é’¥ï¼** ç›´æ¥åœ¨ OpenCode CLI ä¸­ä½¿ç”¨åŒä»£ç† PCG ç³»ç»Ÿã€‚

### å¿«é€Ÿè®¾ç½®

1. å°† `.opencode` ç›®å½•å¤åˆ¶åˆ°ä½ çš„ç”¨æˆ·ä¸»ç›®å½•ï¼š

```bash
# Windows
xcopy /E /I .opencode %USERPROFILE%\.opencode

# Linux/Mac
cp -r .opencode ~/.opencode
```

2. è¿è¡Œ OpenCode å¹¶ä½¿ç”¨ `/Map` å‘½ä»¤ï¼š

```bash
opencode -c
```

```
/Map volcanic island with central crater lake
```

### å·¥ä½œåŸç†

OpenCode é›†æˆåˆ©ç”¨å·²è®¤è¯çš„ Claude ä¼šè¯ï¼Œæ¶ˆé™¤äº†å¯¹å•ç‹¬ API å¯†é’¥çš„éœ€æ±‚ï¼š

```
ç”¨æˆ·: /Map mountain terrain with 3 elevation zones
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Map.md å‘½ä»¤    â”‚ â† ç¼–æ’åè®®æ‰§è¡Œ
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Actor   â”‚     â”‚ Critic  â”‚
â”‚ ä»£ç†    â”‚â”€â”€â”€â”€â–¶â”‚ ä»£ç†    â”‚
â”‚ (t=0.4) â”‚â—€â”€â”€â”€â”€â”‚ (t=0.2) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    JSON å‚æ•°è¾“å‡º
```

### OpenCode æ–‡ä»¶ç»“æ„

```
.opencode/
â”œâ”€â”€ agent/
â”‚   â”œâ”€â”€ pcg-actor.yaml    # Actor ä»£ç† (æ¸©åº¦: 0.4)
â”‚   â””â”€â”€ pcg-critic.yaml   # Critic ä»£ç† (æ¸©åº¦: 0.2)
â””â”€â”€ command/
    â””â”€â”€ Map.md            # å¸¦æœ‰ API æ–‡æ¡£çš„ä¸»æ–œæ å‘½ä»¤
```

### å¯¹æ¯”ï¼šPython API vs OpenCode

| ç‰¹æ€§ | Python API | OpenCode |
|---------|-----------|----------|
| éœ€è¦ API å¯†é’¥ | âœ… æ˜¯ | âŒ **å¦** |
| è®¾ç½®å¤æ‚åº¦ | pip install + ç¯å¢ƒå˜é‡ | å¤åˆ¶æ–‡ä»¶å¤¹ |
| æ¸©åº¦æ§åˆ¶ | âœ… 0.4/0.2 | âœ… 0.4/0.2 |
| Token è¿½è¸ª | ç²¾ç¡® | ä¼°ç®— |
| ä½¿ç”¨æ–¹å¼ | è„šæœ¬/ä»£ç  | `/Map` å‘½ä»¤ |

---

### ğŸ”„ è¿­ä»£ä¼˜åŒ–å·¥ä½œæµï¼ˆæ‰‹åŠ¨å¾ªç¯ï¼‰

ç³»ç»Ÿç”Ÿæˆ PCG å‚æ•°ï¼Œä½†**å®é™…åœ°å›¾ç”Ÿæˆéœ€è¦æ‚¨çš„ PCG å·¥å…·**ï¼ˆå¦‚ TileWorldCreatorï¼‰ã€‚ç”±äºå·¥å…·è®¾ç½®å› ç”¨æˆ·è€Œå¼‚ï¼Œè§†è§‰åé¦ˆå¾ªç¯éœ€è¦æ‰‹åŠ¨è¿›è¡Œï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         è¿­ä»£ä¼˜åŒ–å·¥ä½œæµ                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ç¬¬ä¸€æ­¥ï¼šåˆå§‹å‚æ•°ç”Ÿæˆ                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  /Map [å‚è€ƒå›¾ç‰‡.png]                                         â”‚   â”‚
â”‚  â”‚  æˆ–                                                          â”‚   â”‚
â”‚  â”‚  /Map "å¸¦æœ‰ç«å±±å£æ¹–çš„ç«å±±å²›"                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚                       JSON å‚æ•°è¾“å‡º                                   â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  ç¬¬äºŒæ­¥ï¼šåº”ç”¨åˆ° PCG å·¥å…·ï¼ˆæ‰‹åŠ¨ï¼‰                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Unity + TileWorldCreator                                    â”‚   â”‚
â”‚  â”‚  - å°†å‚æ•°å¤åˆ¶åˆ°ç”Ÿæˆå™¨                                          â”‚   â”‚
â”‚  â”‚  - æ‰§è¡Œåœ°å›¾ç”Ÿæˆ                                                â”‚   â”‚
â”‚  â”‚  - æˆªå–ç»“æœæˆªå›¾                                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚  ç¬¬ä¸‰æ­¥ï¼šåé¦ˆä¸ä¼˜åŒ–                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  /Map [ç»“æœæˆªå›¾.png]                                          â”‚   â”‚
â”‚  â”‚  "ä¹‹å‰çš„å‚æ•°: {...}ï¼Œé—®é¢˜ï¼šå±±å¤ªä½äº†"                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚                        ä¼˜åŒ–åçš„å‚æ•°                                   â”‚
â”‚                              â”‚                                       â”‚
â”‚                              â–¼                                       â”‚
â”‚                      é‡å¤ç›´åˆ°æ»¡æ„                                     â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ä¸ºä»€ä¹ˆæ˜¯æ‰‹åŠ¨å¾ªç¯ï¼Ÿ

> **å› ä¸ºå·¥å…·è®¾ç½®å› ç”¨æˆ·è€Œå¼‚ã€‚** æ¯ä¸ªç”¨æˆ·éƒ½æœ‰è‡ªå·±çš„ PCG å·¥å…·é…ç½®ã€èµ„æºåº“å’Œ Unity é¡¹ç›®è®¾ç½®ã€‚ç³»ç»Ÿæ— æ³•è‡ªåŠ¨æ‰§è¡Œå·¥å…·çš„åŸå› ï¼š
> - TileWorldCreator API å› ç‰ˆæœ¬è€Œå¼‚
> - è‡ªå®šä¹‰å·¥å…·é…ç½®å› ç”¨æˆ·è€Œå¼‚
> - èµ„æºè·¯å¾„å› ç”¨æˆ·è€Œå¼‚
> - Unity é¡¹ç›®ç»“æ„ä¸åŒ
>
> Dual-Agent ç³»ç»Ÿä¸“æ³¨äº**å‚æ•°ç”Ÿæˆ**ï¼Œæ‰§è¡Œäº¤ç»™ç”¨æˆ·çš„ç¯å¢ƒã€‚

#### ç¤ºä¾‹å·¥ä½œæµ

```bash
# 1. ä»å‚è€ƒå›¾åƒç”Ÿæˆåˆå§‹å‚æ•°
/Map ~/reference/mountain_village.png

# 2. å°†ç”Ÿæˆçš„ JSON åº”ç”¨åˆ° TileWorldCreatorï¼ˆæ‰‹åŠ¨ï¼‰
#    â†’ ç”Ÿæˆåœ°å›¾ â†’ æˆªå–ç»“æœ

# 3. åŸºäºç»“æœä¼˜åŒ–
/Map ~/screenshots/attempt1.png "å±±çš„é«˜åº¦å˜åŒ–éœ€è¦æ›´å¤§"

# 4. åº”ç”¨ä¼˜åŒ–åçš„å‚æ•°ï¼ˆæ‰‹åŠ¨ï¼‰
#    â†’ ç”Ÿæˆåœ°å›¾ â†’ æˆªå–ç»“æœ

# 5. ç»§ç»­ç›´åˆ°æ»¡æ„
/Map ~/screenshots/attempt2.png "åœ¨æ–œå¡ä¸Šæ·»åŠ æ›´å¤šæ ‘æœ¨"
```

---

### ç¨‹åºåŒ–ç”¨æ³• (Programmatic Usage)

```python
import asyncio
from dual_agent_pcg.models import SystemConfig
from dual_agent_pcg.llm_providers import create_provider
from dual_agent_pcg.orchestrator import Orchestrator

async def main():
    # ä¸è®ºæ–‡åŒ¹é…çš„é…ç½®ï¼ˆç¬¬ 4.1 èŠ‚ï¼‰
    config = SystemConfig(
        actor_temperature=0.4,   # å¹³è¡¡åˆ›æ„ä¸æŒ‡ä»¤éµå¾ª
        critic_temperature=0.2,  # æä¾›ä¸€è‡´ä¸”è‡ªä¿¡çš„åé¦ˆ
        max_iterations=1         # è®ºæ–‡ä¸­çš„è®¾ç½®
    )
    
    # åˆ›å»ºæä¾›è€…
    llm = create_provider("anthropic", api_key="your-key")
    
    # åˆ›å»ºç¼–æ’å™¨
    orchestrator = Orchestrator(
        config=config,
        llm_provider=llm,
        api_documentation="...",  # ä½ çš„ PCG å·¥å…·æ–‡æ¡£
        usage_examples=["..."]    # è½¨è¿¹ç¤ºä¾‹
    )
    
    # æ‰§è¡Œ
    result = await orchestrator.execute("Create a mountain terrain...")
    
    if result.success:
        print("æ‰¹å‡†çš„è½¨è¿¹:", result.final_trajectory)
    else:
        print("å°½åŠ›è€Œä¸ºçš„ç»“æœ:", result.final_trajectory)

asyncio.run(main())
```

## é¡¹ç›®ç»“æ„ (Project Structure)

```
dual_agent_pcg/
â”œâ”€â”€ .opencode/                    # OpenCode é›†æˆï¼ˆæ–°å¢ï¼ï¼‰
â”‚   â”œâ”€â”€ agent/
â”‚   â”‚   â”œâ”€â”€ pcg-actor.yaml       # Actor ä»£ç†é…ç½® (t=0.4)
â”‚   â”‚   â””â”€â”€ pcg-critic.yaml      # Critic ä»£ç†é…ç½® (t=0.2)
â”‚   â””â”€â”€ command/
â”‚       â””â”€â”€ Map.md               # /Map æ–œæ å‘½ä»¤
â”œâ”€â”€ __init__.py                   # åŒ…åˆå§‹åŒ–
â”œâ”€â”€ models.py                     # Pydantic æ¨¡å‹ (ActorOutput, CriticFeedback ç­‰)
â”œâ”€â”€ prompts.py                    # Actor å’Œ Critic çš„ç³»ç»Ÿæç¤ºè¯
â”œâ”€â”€ llm_providers.py              # LLM æä¾›è€…æŠ½è±¡ï¼ˆAnthropic, OpenAI, Mockï¼‰
â”œâ”€â”€ orchestrator.py               # ç®—æ³• 1 çš„å®ç°
â”œâ”€â”€ main.py                       # å¯è¿è¡Œç¤ºä¾‹
â”œâ”€â”€ config.yaml                   # é…ç½®æ–‡ä»¶
â””â”€â”€ requirements.txt              # ä¾èµ–é¡¹
```

## è®ºæ–‡é…ç½® (Paper Configuration)ï¼ˆç¬¬ 4.1 èŠ‚ï¼‰

| è®¾ç½® | æ•°å€¼ | ä¾æ® |
|---------|-------|-----------|
| LLM æ¨¡å‹ | Claude 4.5 Sonnet | è®ºæ–‡çš„é€‰æ‹© |
| Actor æ¸©åº¦ | 0.4 | "å¹³è¡¡åˆ›æ„ä¸æŒ‡ä»¤éµå¾ª" |
| Critic æ¸©åº¦ | 0.2 | "æä¾›ä¸€è‡´ä¸”è‡ªä¿¡çš„åé¦ˆ" |
| æœ€å¤§è¿­ä»£æ¬¡æ•° | 1 | "æ‰€æœ‰è¯•éªŒå‡è®¾ä¸º 1" |

## æ ¸å¿ƒç»„ä»¶ (Key Components)

### Actor ä»£ç†ï¼ˆè¯­ä¹‰è§£é‡Šå™¨ï¼‰
- å°†è‡ªç„¶è¯­è¨€è½¬æ¢ä¸ºå‚æ•°è½¨è¿¹åºåˆ— (Parameter Trajectory Sequence)
- è¾“å‡ºï¼š`{trajectory_summary, tool_plan, risks}`
- ç¦æ­¢ç›´æ¥æ‰§è¡Œå·¥å…·

### Critic ä»£ç†ï¼ˆé™æ€éªŒè¯å™¨ï¼‰
- æ ¹æ®æ–‡æ¡£è¯„ä¼°è½¨è¿¹
- äº”ç»´è¯„å®¡æ¡†æ¶ï¼š
  1. å·¥å…·é€‰æ‹© (Tool Selection)
  2. å‚æ•°æ­£ç¡®æ€§ (Parameter Correctness)
  3. é€»è¾‘ä¸é¡ºåº (Logic & Sequence)
  4. ç›®æ ‡å¯¹é½ (Goal Alignment)
  5. å®Œæ•´æ€§ (Completeness)
- ä¿å®ˆç­–ç•¥ï¼šä»…åœ¨ç¡®å®šå­˜åœ¨é˜»å¡æ€§é—®é¢˜æ—¶æ‰æ ‡è®°

### ä¸Šä¸‹æ–‡ç®¡ç†å™¨ (Context Manager)
- å®ç°çŠ¶æ€æ›¿æ¢ç­–ç•¥ (State-Replacement Strategy)ï¼ˆç¬¬ 3.3 èŠ‚ï¼‰
- å›ºå®šå¤§å°çš„ä¸Šä¸‹æ–‡ç¼“å†²åŒº
- è¦†ç›–ä¹‹å‰çš„è½¨è¿¹ï¼ˆè€Œéè¿½åŠ ï¼‰

## ç®—æ³• 1ï¼šé›¶æ ·æœ¬åŒä»£ç† PCG ä¼˜åŒ– (Zero-shot Dual-Agent PCG Refinement)

```
è¾“å…¥: P_user, D, E, K
è¾“å‡º: S_final

Context_actor <- {P_user, D, E}
S_0 <- Actor(Context_actor)
i <- 0

while i < K do:
    Feedback <- Critic(S_i, D, E)
    if Feedback = empty then
        return S_i
    Context_actor <- UpdateContext(S_i, Feedback)
    S_{i+1} <- Actor(Context_actor)
    i <- i + 1

return S_K
```

## è®¸å¯è¯ (License)

æœ¬å®ç°ä»…ç”¨äºæ•™è‚²å’Œç ”ç©¶ç›®çš„ã€‚

## å¼•ç”¨ (Citation)

```bibtex
@article{her2025zeroshot3dmap,
  title={Zero-shot 3D Map Generation with LLM Agents: A Dual-Agent Architecture for Procedural Content Generation},
  author={Her, Lim Chien and Yan, Ming and Bai, Yunshu and Li, Ruihao and Zhang, Hao},
  journal={arXiv preprint arXiv:2512.10501},
  year={2025}
}
```
